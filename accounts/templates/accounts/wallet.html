{% extends "base.html" %}
{% block title %}Wallet{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="m-0">ğŸ’° éŒ¢åŒ…</h3>
  <a class="btn btn-outline-light" href="{% url 'shop:list' %}">å‰å¾€å•†åº—</a>
</div>

<div class="row g-3 mb-3">
  <div class="col-12 col-lg-6">
    <div class="card p-3 h-100">
      <div class="d-flex justify-content-between align-items-center">
        <div class="text-muted">ç›®å‰é¤˜é¡</div>
        <span class="badge bg-warning text-dark fs-6">{{ wallet.balance }}</span>
      </div>

      <div class="small text-muted mt-2">
        * é‡‘é¡ç‚ºæ•´æ•¸ï¼ˆBigIntegerï¼‰ï¼Œé¿å…æµ®é»èª¤å·®
      </div>
    </div>
  </div>

  <div class="col-12 col-lg-6">
    <div class="card p-3 h-100">
      <h5 class="mb-3">å¿«é€Ÿæ“ä½œ</h5>

      <div class="d-flex flex-wrap gap-2 align-items-center">
        <form method="post" action="{% url 'accounts:deposit' %}" class="d-flex gap-2">
          {% csrf_token %}
          <input
            type="number"
            name="amount"
            class="form-control form-control-sm"
            placeholder="å„²å€¼é‡‘é¡"
            min="1"
            step="1"
            required
            style="max-width: 160px;"
          >
          <button class="btn btn-success btn-sm" type="submit">å„²å€¼</button>
        </form>

        <form method="post" action="{% url 'accounts:withdraw' %}" class="d-flex gap-2">
          {% csrf_token %}
          <input
            type="number"
            name="amount"
            class="form-control form-control-sm"
            placeholder="æé ˜é‡‘é¡"
            min="1"
            step="1"
            required
            style="max-width: 160px;"
          >
          <button class="btn btn-danger btn-sm" type="submit">æé ˜</button>
        </form>
      </div>

      <div class="small text-muted mt-2">
        æç¤ºï¼šæé ˜æœƒæª¢æŸ¥é¤˜é¡ï¼Œä¸è¶³æœƒå¤±æ•—ï¼ˆç”± views é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ï¼‰
      </div>
    </div>
  </div>
</div>

<div class="card p-3">
  <h5 class="mb-3">äº¤æ˜“ç´€éŒ„</h5>

  <div class="table-responsive">
    <table class="table table-dark table-sm align-middle mb-0">
      <thead>
        <tr>
          <th>æ™‚é–“</th>
          <th>é¡å‹</th>
          <th class="text-end">é‡‘é¡</th>
          <th>Ref</th>
          <th>å‚™è¨»</th>
        </tr>
      </thead>
      <tbody>
      {% for tx in txs %}
        <tr>
          <td class="text-nowrap">{{ tx.created_at|date:"Y-m-d H:i:s" }}</td>
          <td>{{ tx.tx_type }}</td>
          <td class="text-end">
            {% if tx.amount >= 0 %}
              <span class="text-success">+{{ tx.amount }}</span>
            {% else %}
              <span class="text-danger">{{ tx.amount }}</span>
            {% endif %}
          </td>
          <td class="text-muted">{{ tx.ref }}</td>
          <td class="text-muted">{{ tx.note }}</td>
        </tr>
      {% empty %}
        <tr><td colspan="5" class="text-muted">å°šç„¡äº¤æ˜“ç´€éŒ„</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
